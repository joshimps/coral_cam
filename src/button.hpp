#include "rclcpp/rclcpp.hpp"
#include "std_msgs/msg/bool.hpp"
#include <lgpio.h>
#include <functional>
#include <memory>
#include <chrono> 
using namespace std::chrono_literals;

namespace coral_cam{
    class Button : public rclcpp::Node{
        public:
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Constructors and Destructors                                                                          //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
            Button(const rclcpp::NodeOptions &options);
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Public Methods                                                                                        //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
        private:
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Callbacks                                                                                             //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
            void timerCallback();
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Private Methods                                                                                       //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////

            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Node,Timers, Publishers and Subscribers                                                                      //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
            rclcpp::Publisher<std_msgs::msg::Bool>::SharedPtr buttonPressedPublisher_;
            rclcpp::TimerBase::SharedPtr timer_;
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Constants                                                                                             //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
            const int lflags_ = 0;
            ////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Variables                                                                                             //
            //////////////////////////////////////////////////////////////////////////////////////////////////////////
            int gpioHandle_;
            int buttonPinNumber_;
            std_msgs::msg::Bool buttonPressedMessage_;

    };  
}